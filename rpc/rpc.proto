syntax="proto3";

service LonghornLauncherService {
	rpc UpgradeEngine(Engine) returns (Empty) {}
	rpc GetInfo(Empty) returns (Info) {}
	rpc StartFrontend(Identity) returns (Empty) {}
	rpc ShutdownFrontend(Identity) returns (Empty) {}
	rpc StartEngineFrontend(Frontend) returns (Empty) {}
	rpc ShutdownEngineFrontend(Empty) returns (Empty) {}
}

message Engine {
	string binary = 1;
	repeated string replicas = 2;
}

message Info {
	string volume = 1;
	string frontend = 2;
	string endpoint = 3;
}

message Identity {
	string ID = 1;
}

message Frontend {
	string Frontend = 1;
};

message Empty {
}

service LonghornEngineLauncherService {
	rpc EngineStart(EngineStartRequest) returns (EngineResponse) {}
	rpc EngineStop(EngineStopRequest) returns (EngineResponse) {}
	rpc EngineGet(EngineGetRequest) returns (EngineResponse) {}
	rpc EngineList(EngineListRequest) returns (EngineListResponse) {}

	//rpc StartReplica(StartReplicaRequest) returns (StartReplicaResponse) {}
	//rpc StopReplica(StopReplicaRequest) returns (StopReplicaResponse) {}
	//rpc ListReplicas(ListReplicasRequest) returns (ListReplicasResponse) {}
}

message EngineSpec {
	string name = 1;
	string binary = 2;
	repeated string args = 3;
	repeated int32 reserved_ports = 4;
}

message EngineStatus {
	string status = 1;
	string error_msg = 2;
}

message EngineStartRequest {
	EngineSpec spec = 1;
}

message EngineStopRequest {
	string name = 1;
}

message EngineGetRequest {
	string name = 1;
}

message EngineResponse {
	EngineSpec spec = 1;
	EngineStatus status = 2;
}

message EngineListRequest{
}

message EngineListResponse{
	repeated EngineResponse engines = 1;
}
